extend /_layout.pug

mixin toTds(xs)
  for x in xs
    td
      if x && x[0] === "!"
        em= x.substring(1)
      else
        | #{x}

mixin toTrs(xss, sep="|")
  for xs in xss
    tr
      +toTds(xs.split(sep))

block head
  - const title = "cantonese"
  link(rel="stylesheet", href="../style.css")
  link(rel="stylesheet", href="style.css")
  script(src="convert.js")
  script(src="script.js")

block main
  +mySection("example")
    center
      table.example
        tbody.original
          tr: th original
          tr: td 春曉（孟浩然）
          tr: td 春眠不覺曉，
          tr: td 處處聞啼鳥。
          tr: td 夜來風雨聲，
          tr: td 花落知多少？
        tbody.cantonese-pinyin
          tr: th cantonese pinyin
          tr: td tsoen1 hiu2 (maang6 hou6 jin4)
          tr: td tsoen1 min4 bat7 gok8 hiu2
          tr: td tsy3 tsy3 man4 tai4 niu5
          tr: td je6 loi4 fung1 jy5 sing1
          tr: td faa1 lok9 dzi1 do1 siu2
        tbody.jyutping
          tr: th jyutping
          tr: td ceon1 hiu2 (maang6 hou6 jin4)
          tr: td ceon1 min4 bat1 gok3 hiu2
          tr: td cyu3 cyu3 man4 tai4 niu5
          tr: td je6 loi4 fung1 jyu5 sing1
          tr: td faa1 lok6 zi1 do1 siu2
        tbody.author-diacritic
          tr: th #{author.name}-diacritic
        tbody(style="display: none").author-ascii
          tr: th #{author.name}-ASCII
        tbody.author-alphabet
          tr: th #{author.name}-alphabet

  +mySection("tables")
    center
      table
        caption IPA
        tbody.consonant
          +toTrs(
            [ "p  |pʰ |m |f | "
            , "t\u0361s|t\u0361sʰ||s|j"
            , "t  |tʰ |n |  |l"
            , "kʷ |kʷʰ|  |  |w"
            , "k  |kʰ |ŋ |h | "
            , "ʔ"
            ]
          )
        tbody.vowel
          +toTrs([
          "iː|   |iːu|iːm|iːn|!ɪŋ|iːp|iːt|!ɪk ",
          "yː|   |   |   |yːn|   |   |yːt|    ",
          "uː|uːi|   |   |uːn|!ʊŋ|   |uːt|!ʊk",
          "ɛː|!ei|ɛːu|ɛːm|ɛːn|ɛːŋ|ɛːp|   |ɛːk ",
          "œː|!ɵy|   |   |!ɵn|œːŋ|   |!ɵt|œːk",
          "ɔː|ɔːy|!ou|   |ɔːn|ɔːŋ|   |ɔːt|ɔːk",
          "aː|aːi|aːu|aːm|aːn|aːŋ|aːp|aːt|aːk",
          "  | ɐi| ɐu| ɐm| ɐn| ɐŋ| ɐp| ɐt| ɐk",
          "  |   |   |  m|   |  ŋ|   |   |   "
          ])

      table#cantonese-me
        caption #{author.name}

      table#cantonese-pinyin
        caption 教育學院拼音方案 (cantonese pinyin)
        tbody.consonant
          +toTrs(
            [ "b |p |m |f| "
            , "d |t |n | |l"
            , "g |k |ng|h| "
            , "gw|kw|  | |w"
            , "dz|ts|  |s|j"
            , "∅"
            ]
          )
        tbody.vowel
          +toTrs([
          "i |   |iu |im |in |ing |ip |it |ik ",
          "y |   |   |   |yn |    |   |yt |   ",
          "u |ui |   |   |un |ung |   |ut |uk ",
          "e |ei |eu |em |en |eng |ep |   |ek ",
          "oe|oey|   |   |oen|oeng|   |oet|oek",
          "o |oi |ou |   |on |ong |   |ot |ok ",
          "aa|aai|aau|aam|aan|aang|aap|aat|aak",
          "  |ai |au |am |an |ang |ap |at |ak ",
          "  |   |   |  m|   |  ng|   |   |   "
          ])

      table
        caption 香港語言學學會粵語拼音方案 (jyutping)
        tbody.consonant
          +toTrs(
            [ "b |p |m |f| "
            , "d |t |n | |l"
            , "g |k |ng|h| "
            , "gw|kw|  | |w"
            , "z |c |s | |j"
            , "∅"
          ])
        tbody.vowel
          +toTrs([
            "i |   |iu |im |in |ing |ip |it |ik ",
            "yu|   |   |   |yun|    |   |yut|   ",
            "u |ui |   |   |un |ung |   |ut |uk ",
            "e |ei |eu |em |en |eng |ep |   |ek ",
            "oe|eoi|   |   |eon|oeng|   |eot|oek",
            "o |oi |ou |   |on |ong |   |ot |ok ",
            "aa|aai|aau|aam|aan|aang|aap|aat|aak",
            "  |ai |au |am |an |ang |ap |at |ak ",
            "  |   |   |  m|   |  ng|   |   |   "
          ])

      table
        caption tones
        tbody.tone
          for xs in ["陰平|陰上|陰去|陽平|陽上|陽去|上陰入|下陰入|陽入", "絲|史|試|時|市|士|式|錫|食"]
            tr
              td
              for x in xs.split("|")
                th= x
          -
            let xss =
              [ ["cantonese pinyin", " 1| 2| 3| 4| 5| 6| 7| 8| 9"]
              , ["jyutping        ", " 1| 2| 3| 4| 5| 6| 1| 3| 6"]
              , ["pseudo-IPA",       "˥˧|˧˥| ˧|˧˩|˩˧| ˩| ˥| ˧| ˩"]
              //, ["IPA-diacritic",    "𝑣\u0302|𝑣\u030C|𝑣|𝑣\u1DC6|𝑣\u1DC5|𝑣\u0300|𝑣\u0301|𝑣|𝑣\u0300"]
              , [`${author.name}-diacritic`,                               ]
              //, [`${author.name}-ASCII`,                                   ]
              , [`${author.name}-alphabet`,    "𝐶𝑣𝑐|𝑐𝑉𝐶|𝑐𝑣𝑐|𝐶𝑣𝑐x|𝑐𝑉𝐶x|𝑐𝑣𝑐x|𝐶𝑣𝑐|𝑐𝑣𝑐|𝑐𝑣𝑐x"]
              //, [`${author.name}-mixed`,    ]
              ]
          for xs in xss
            tr
              th(align="right")= xs[0]
              if xs[1]
                +toTds(xs[1].split("|"))

    ul
      li for any ‹i, u, e, ø›, we may ignore its length, respectively.
      li for any 𝑣𝑐𝑐, we may replace it with 𝑣&#x0306;𝑐 (in a narrow environment like a ruby).
      li for any ‹ŋ, ø›, we may replace it with ‹q, w›, respectively.
      li if the initial is necessary,
        ul
          li for any 𝑐=‹› preceding a nasal 𝑣, we may let 𝑐←𝑣.
          li for any other 𝑐=‹›, we may let 𝑐←‹x›.
      //li for any space between syllables, we may omit it and add a diaeresis to the initial.
      //li the author thinks that the alphabetical spelling combined with the mixed tone-notation is the easiest for learners to memorize (especially whose native language has no diacritcal mark)
    p
      | influenced by
      ul
        li jyutpin (distinguishes /œː, ɵ/ and uses not ‹dz, ts› but just ‹z, c› for /dz, ts/)
        li cantonese pinyin (uses not ‹yu› but just ‹y› for /y/)
        li eulwjbaq (uses ‹q, w› for /ŋ, ø/)
        li latin (uses not ‹w› but ‹v› for /w/)
        li various languages (double consonants to indicate short vowels)

  +mySection("converter")
    div.converter
      div.center
        ul.option
          li
            select.trigger(name="tone", size="1")
              option(value="none") none
              option(value="number") number
              option(value="ipa") pseudo-IPA
              option(value="diacritic", selected) diacritic
              option(value="ascii") ASCII
              option(value="alphabet") alphabet
              //option(value="mixed", selected) mixed
            label tone
          li
            input.trigger(type="checkbox", name="letter")
            label ‹ŋ, ø›→‹q, w›
          li
            input.trigger(type="checkbox", name="alphabet")
            label ‹a›𝑐𝑐→‹a&#x0306;›𝑐
          li
            input.trigger(type="checkbox", name="omit-length")
            label omit optional vowel length
          li
            input.trigger(type="checkbox", name="ruby")
            label show as ruby
          // li
            input.trigger(type="checkbox", name="diaeresis")
            label ‹ ›𝑐→𝑐&#x0308;

      div.from-to
        textarea.from.trigger(placeholder="cantonese pinyin / jyutping / 漢字")
          | 人生自古誰無死？

        div.to-select
        div.to

      div.center
        a.tweet(
          href=""
          , onClick="window.open(encodeURI(decodeURI(this.href)), 'tweetwindow', 'width=650, height=470, personalbar=0, toolbar=0, scrollbars=1, sizable=1'); return false;"
          , rel="nofollow"
          , class="twitter-link"
          ) tweet

    p: em
      | this program uses&#x20;
      a(href="https://github.com/lshk-org/jyutping-table") 電腦用漢字粵語拼音表
      |  licensed under&#x20;
      a(href="https://creativecommons.org/licenses/by/4.0/deed.en") CC BY 4.0
      | .

  +mySection("千字文")
    p: em the text below is automatically generated and therefore has some inaccurate rubies especially for characters which have multiple sounds.

    div.center
      include _cinzimann.pug